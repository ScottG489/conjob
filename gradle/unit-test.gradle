sourceSets {
    unitTest {
        java.srcDirs = ['src/test/unit/java']
        resources.srcDir file('src/test/unit/resources')
        compileClasspath += sourceSets.main.output + configurations.testRuntimeClasspath
        runtimeClasspath += output + compileClasspath
    }
}

ext.jqwikVersion = '1.5.0'

task unitTest(type: Test) {
    testClassesDirs = sourceSets.unitTest.output.classesDirs
    classpath = sourceSets.unitTest.runtimeClasspath

    useJUnitPlatform()

    mustRunAfter build
    finalizedBy jacocoTestReport
}

dependencies {
    testCompile "org.mockito:mockito-core:3.8.0"
    testImplementation(platform('org.junit:junit-bom:5.7.1'))
    testImplementation('org.junit.jupiter:junit-jupiter')
    testImplementation "net.jqwik:jqwik:${jqwikVersion}"
}

jacocoTestReport {
    dependsOn unitTest
    getExecutionData().setFrom(fileTree(buildDir).include("/jacoco/unitTest.exec"))
}